<h1 id="custom-hook">Custom Hook<a aria-hidden="true" class="anchor-heading icon-link" href="#custom-hook"></a></h1>
<p>We can also use a custom hook to provide the same query in multiple components. This lets us keep the query function local to the query that is using it while still allowing the query to be used across multiple components.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">useGithubIssuesQuery</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> owner<span class="token punctuation">,</span> repo<span class="token punctuation">,</span> filters <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">getIssues</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filterQuery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>filters<span class="token punctuation">.</span><span class="token property-access">assignee</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      filterQuery<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">"assignee"</span><span class="token punctuation">,</span> filters<span class="token punctuation">.</span><span class="token property-access">assignee</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>filters<span class="token punctuation">.</span><span class="token property-access">labels</span> <span class="token operator">&#x26;&#x26;</span> filters<span class="token punctuation">.</span><span class="token property-access">labels</span><span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      filterQuery<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">"labels"</span><span class="token punctuation">,</span> filters<span class="token punctuation">.</span><span class="token property-access">labels</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>filters<span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      filterQuery<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">"state"</span><span class="token punctuation">,</span> filters<span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> filterQueryString <span class="token operator">=</span> filterQuery<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword control-flow">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.github.com/repos/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>owner<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>repo<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/issues</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
        filterQueryString <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>filterQueryString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">""</span>
      <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token arrow operator">=></span> res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token function">useQuery</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token string">"issues"</span><span class="token punctuation">,</span> owner<span class="token punctuation">,</span> repo<span class="token punctuation">,</span> filters<span class="token punctuation">]</span><span class="token punctuation">,</span>
    getIssues
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We can now use this in any component anywhere in our app and be confident that all of the queries are sharing the same cache data and minimizing the number of network requests.</p>