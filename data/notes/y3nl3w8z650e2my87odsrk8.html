<h1 id="mock-property">.mock Property<a aria-hidden="true" class="anchor-heading icon-link" href="#mock-property"></a></h1>
<p>All mock functions have a <code>.mock</code> property which is where the data about how the function has been called, it's return values are stored.</p>
<p>The <code>.mock</code> property also tracks the value of <code>this</code> for each call, so it's possible to inspect <code>this</code> as well.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> myMock1 <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">myMock1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>myMock1<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">instances</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// > [ &#x3C;a> ]</span>

<span class="token keyword">const</span> myMock2 <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bound <span class="token operator">=</span> myMock2<span class="token punctuation">.</span><span class="token method function property-access">bind</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">bound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>myMock2<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">contexts</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// > [ &#x3C;b> ]</span>
</code></pre>
<p>The mock members are quite useful in tests to assert:</p>
<ol>
<li>How the functions get called?</li>
<li>How the functions get instantiated?</li>
<li>What they returned?</li>
</ol>
<p>e.g.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// The function was called exactly once</span>
<span class="token function">expect</span><span class="token punctuation">(</span>someMockFunction<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">calls</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// The first arg of the first call to the function was 'first arg'</span>
<span class="token comment">// First parameter signifies the first call and the second parameter signifies the 1st argument in that call</span>
<span class="token function">expect</span><span class="token punctuation">(</span>someMockFunction<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">calls</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token string">'first arg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// The second arg of the first call to the function was 'second arg'</span>
<span class="token function">expect</span><span class="token punctuation">(</span>someMockFunction<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">calls</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token string">'second arg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// The return value of the first call to the function was 'return value'</span>
<span class="token function">expect</span><span class="token punctuation">(</span>someMockFunction<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">results</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token string">'return value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// The function was called with a certain `this` context: the `element` object.</span>
<span class="token function">expect</span><span class="token punctuation">(</span>someMockFunction<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">contexts</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This function was instantiated exactly twice</span>
<span class="token function">expect</span><span class="token punctuation">(</span>someMockFunction<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">instances</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// The object returned by the first instantiation of this function</span>
<span class="token comment">// had a `name` property whose value was set to 'test'</span>
<span class="token function">expect</span><span class="token punctuation">(</span>someMockFunction<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">instances</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toEqual</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// The first argument of the last call to the function was 'test'</span>
<span class="token function">expect</span><span class="token punctuation">(</span>someMockFunction<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">lastCall</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>